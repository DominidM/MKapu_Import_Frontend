<div class="conteo-page">

    <!-- ================= HEADER ================= -->
    <p-card class="conteo-header-card">
      <div class="flex align-items-center justify-content-between flex-wrap gap-3">
  
        <div class="flex align-items-center gap-3">
          <span class="sedes-title-icon">
            <i class="pi pi-chart-line"></i>
          </span>
          <div>
            <p class="sedes-kicker">
              ADMINISTRADOR · ADMINISTRACIÓN · CONTEOS
            </p>
            <h2 class="sedes-title">
              CONTEOS DE INVENTARIO
            </h2>
          </div>
        </div>
  
        <p-button
        label="Crear Nuevo Conteo"
        icon="pi pi-plus"
        [routerLink]="['/admin/conteo-crear']">
      </p-button>
      
  
      </div>
    </p-card>
  
    <!-- ================= FILTROS ================= -->
    <p-card class="mt-3 filtros-card">
  
      <div class="flex flex-wrap gap-3 align-items-center">
  
        <!-- Fecha -->
        <p-datepicker
          [(ngModel)]="fechaSeleccionada"
          dateFormat="dd/mm/yy"
          placeholder="dd/mm/yyyy"
          (onSelect)="aplicarFiltros()"
          [showIcon]="true">
        </p-datepicker>
  
        <!-- Buscador -->
        <span class="p-input-icon-left flex-1">
          <i class="pi pi-search"></i>
          <input
            pInputText
            type="text"
            placeholder="Buscar por detalle..."
            [(ngModel)]="filtroBusqueda"
            (input)="aplicarFiltros()" />
        </span>
  
        <!-- Estado -->
        <p-autoComplete
        [(ngModel)]="estadoSeleccionado"
        [suggestions]="estadosFiltrados"
        (completeMethod)="filtrarEstados($event)"
        (onSelect)="aplicarFiltros()"
        optionLabel="nombre"
        placeholder="Estado"
        [dropdown]="true">
        </p-autoComplete>

        <!-- Familia -->
        <p-autoComplete
        [(ngModel)]="familiaSeleccionada"
        [suggestions]="familiasFiltradas"
        (completeMethod)="filtrarFamilias($event)"
        (onSelect)="aplicarFiltros()"
        optionLabel="nombre"
        placeholder="Familia"
        [dropdown]="true">
      </p-autoComplete>
      
      </div>
  
    </p-card>
  
    <!-- ================= TABLA ================= -->
    <p-card class="mt-3 tabla-card">
  
      <p-table
        [value]="conteosFiltrados"
        responsiveLayout="scroll">
  
        <ng-template pTemplate="header">
          <tr>
            <th>Fecha</th>
            <th>Detalle</th>
            <th>Estado</th>
            <th>Familia</th>
            <th>Acción</th>
          </tr>
        </ng-template>
  
        <ng-template pTemplate="body" let-row>
          <tr>
            <td>{{ row.fecha }}</td>
            <td>{{ row.detalle }}</td>
            <td>
              <p-tag
                [value]="row.estado"
                [severity]="
                  row.estado === 'Finalizado' ? 'success' :
                  row.estado === 'Anulado' ? 'danger' :
                  'info'
                ">
              </p-tag>
            </td>
            <td>{{ row.familia }}</td>
            <td>
              <button
                pButton
                type="button"
                label="Ver detalle"
                class="p-button-text"
                styleClass="sedes-pill"
                [routerLink]="['/admin/conteo-detalle']">
              </button>
            </td>
          </tr>
        </ng-template>
  
      </p-table>
  
    </p-card>
  
  </div>
  