<div class="contenedor-carga">
  <div *ngIf="cargando" class="mensaje-carga">
    <i class="pi pi-spin pi-spinner" style="font-size: 3rem; color: #666"></i>
    <h3>Cargando comprobante...</h3>
  </div>

  <div *ngIf="!cargando && comprobante && sede" class="vista-previa-comprobante">
    <div class="comprobante-header">
      <h2>{{ sede.nombre }}</h2>
      <p class="razon-social">{{ sede.razon_social }}</p>
      <p class="ruc">RUC: {{ sede.ruc }}</p>
    </div>

    <div class="comprobante-tipo">
      <p class="tipo-label">{{ tipoComprobante }}</p>
      <p class="serie-numero">{{ serieNumero }}</p>
    </div>

    <div class="divider"></div>

    <div class="datos-cliente">
      <div class="dato-row">
        <span class="label">Cliente:</span>
        <span class="valor">{{ nombreCliente }}</span>
      </div>
      <div class="dato-row">
        <span class="label">Documento:</span>
        <span class="valor">{{ documentoCliente }}</span>
      </div>
      <div class="dato-row">
        <span class="label">Fecha:</span>
        <span class="valor">{{ fechaFormateada }}</span>
      </div>
    </div>

    <div class="divider"></div>

    <div class="productos-lista">
      <div class="productos-header">
        <span>Producto</span>
        <span>Cant.</span>
        <span>P.U.</span>
        <span>Total</span>
      </div>
      <div class="producto-item" *ngFor="let item of comprobante.items || comprobante.detalles">
        <span class="producto-nombre">{{ getNombreProducto(item) }}</span>
        <span class="cantidad">{{ item.cantidad }}</span>
        <span class="precio-unit">{{ getPrecioUnitario(item) | number: '1.2-2' }}</span>
        <span class="subtotal">{{ getSubtotalItem(item) | number: '1.2-2' }}</span>
      </div>
    </div>

    <div class="divider"></div>

    <div class="totales-section">
      <div class="total-row">
        <span class="label">Subtotal:</span>
        <span class="valor">S/. {{ comprobante.subtotal | number: '1.2-2' }}</span>
      </div>
      <div class="total-row" *ngIf="comprobante.igv > 0">
        <span class="label">IGV (18%):</span>
        <span class="valor">S/. {{ comprobante.igv | number: '1.2-2' }}</span>
      </div>
      <div class="total-row total-final">
        <span class="label">TOTAL:</span>
        <span class="valor">S/. {{ comprobante.total | number: '1.2-2' }}</span>
      </div>
      <div class="forma-pago">
        <span class="label">Forma de Pago:</span>
        <span class="valor">{{ formaPago }}</span>
      </div>
    </div>

    <div class="comprobante-footer">
      <p>Â¡Gracias por su compra!</p>
      <p class="small">Conserve su comprobante</p>
    </div>
  </div>

  <div *ngIf="!cargando" class="botones-control">
    
    <p-button label="Ver / Imprimir" icon="pi pi-print" severity="info" (onClick)="generarPDF()" />

    <p-button label="Descargar PDF" icon="pi pi-download" (onClick)="descargarPDF()" />

    <p-button label="Volver" icon="pi pi-arrow-left" severity="secondary" (onClick)="volver()" />
  </div>
</div>
